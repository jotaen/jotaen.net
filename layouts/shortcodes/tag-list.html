<script>
  function appendHashtag(tag) {
    window.location.hash = tag === "_all" ? "" : tag;
  }

  function filterList(tag) {
    const currentTag = window.location.hash.substr(1);
    const elements = document.querySelectorAll('[data-tags]');
    Array.prototype.forEach.call(elements, function(e) {
      const tags = e.getAttribute("data-tags").split(" ");
      const isShown = tags.includes(currentTag) || currentTag === "";
      e.style.display = isShown ? "block" : "none";
    });
    document.getElementById('all-tags').value = currentTag || "_all";
  }

  window.addEventListener("hashchange", filterList, false);

  window.addEventListener("load", function() {
    const currentTag = window.location.hash.substr(1);
    if (currentTag !== "") {
      filterList();
    }
  });
</script>

<select id="all-tags" onchange="appendHashtag(this.value)">
  <option value="_all">Show all</option>
  <option disabled>────────────</option>
  {{ range $name, $taxonomy := .Site.Taxonomies.tags }}
    <option value="{{ $name | urlize }}">{{ $name }}</option>
  {{ end }}
</select>
